###############################################################################
#                         Step 5: Decision Tree Model & Prediction
###############################################################################
# Load libraries
library(rpart)        # Decision tree
library(rpart.plot)   # Tree visualization
###############################################################################
#                         Step 5: Decision Tree Model & Prediction
###############################################################################
install.packages("rpart.plot")
###############################################################################
#                         Step 5: Decision Tree Model & Prediction
###############################################################################
install.packages("caret")
###############################################################################
#                          Step 5: Model & Prediction
###############################################################################
# Load libraries
library(rpart)        # Decision tree
library(caret)        # Train/test split, confusion matrix
###############################################################################
#                          Step 5: Model & Prediction
###############################################################################
install.packages(c("rpart", "rpart.plot", "DMwR", "e1071"))
###############################################################################
#                          Step 5: Model & Prediction
###############################################################################
# Load libraries
library(rpart)        # Decision tree
library(caret)        # Train/test split, confusion matrix
###############################################################################
#                          Step 5: Model & Prediction
###############################################################################
install.packages("caret", type = "binary")
###############################################################################
#                          Step 5: Model & Prediction (No caret)
###############################################################################
# Load libraries
library(rpart)        # Decision tree
library(rpart.plot)   # Plotting decision tree
library(DMwR)         # SMOTE for class imbalance
###############################################################################
#                          Step 5: Model & Prediction (No caret)
###############################################################################
install.packages("DMwR")
###############################################################################
#                          Step 5: Model & Prediction (No caret)
###############################################################################
# Load libraries
library(rpart)        # Decision tree
library(rpart.plot)   # Plotting decision tree
library(DMwR)         # SMOTE for class imbalance
###############################################################################
#                          Step 5: Model & Prediction (No caret)
###############################################################################
# Load libraries
library(rpart)
library(rpart.plot)
library(smotefamily)  # modern SMOTE
###############################################################################
#                          Step 5: Model & Prediction (No caret)
###############################################################################
install.packages("smotefamily")
###############################################################################
#                          Step 5: Model & Prediction (No caret)
###############################################################################
# Load libraries
library(rpart)
library(rpart.plot)
library(smotefamily)  # modern SMOTE
# Read cleaned dataset
df <- read.csv("cleaned_stroke_data.csv")
# Convert target variable to factor
df$stroke <- as.factor(df$stroke)
# -----------------------------
# Train/Test Split (70%/30%)
# -----------------------------
set.seed(123)
sample_index <- sample(1:nrow(df), size = 0.7 * nrow(df))
trainData <- df[sample_index, ]
testData <- df[-sample_index, ]
# Check class distribution
table(trainData$stroke)
# -----------------------------
# Apply SMOTE using smotefamily
# -----------------------------
set.seed(123)
# smotefamily::SMOTE requires target as numeric
trainData_num <- trainData
trainData_num$stroke <- as.numeric(as.character(trainData_num$stroke))  # convert factor to 0/1
smote_out <- SMOTE(X = trainData_num[ , !(names(trainData_num) %in% "stroke")],
target = trainData_num$stroke, K=5, dup_size=2)
###############################################################################
#                          Step 5: Model & Prediction
###############################################################################
# Load libraries
library(rpart)        # Decision tree
library(rpart.plot)   # Plotting decision tree
library(smotefamily)  # Modern SMOTE for class imbalance
# -----------------------------
# Read cleaned dataset
# -----------------------------
df <- read.csv("cleaned_stroke_data.csv")
# Convert target variable to factor
df$stroke <- as.factor(df$stroke)
# -----------------------------
# Train/Test Split (70%/30%)
# -----------------------------
set.seed(123)  # for reproducibility
sample_index <- sample(1:nrow(df), size = 0.7 * nrow(df))
trainData <- df[sample_index, ]
testData  <- df[-sample_index, ]
# Check class distribution
table(trainData$stroke)
# -----------------------------
# Apply SMOTE using smotefamily
# -----------------------------
# smotefamily requires all input features to be numeric
trainData_num <- trainData
# Identify categorical columns
categorical_cols <- c("hypertension","heart_disease","ever_married",
"work_type","smoking_status")
# Convert categorical variables to numeric
trainData_num[categorical_cols] <- lapply(trainData_num[categorical_cols], function(x) as.numeric(as.factor(x)))
# Convert target to numeric for SMOTE
trainData_num$stroke <- as.numeric(as.character(trainData_num$stroke))
# Apply SMOTE
set.seed(123)
smote_out <- SMOTE(X = trainData_num[, !(names(trainData_num) %in% "stroke")],
target = trainData_num$stroke, K = 5, dup_size = 2)
###############################################################################
#                          Step 5: Model & Prediction
###############################################################################
# Load libraries
library(rpart)        # Decision tree
library(rpart.plot)   # Plotting decision tree
library(smotefamily)  # Modern SMOTE for class imbalance
# -----------------------------
# Read cleaned dataset
# -----------------------------
df <- read.csv("cleaned_stroke_data.csv")
# Convert target variable to factor
df$stroke <- as.factor(df$stroke)
# -----------------------------
# Train/Test Split (70%/30%)
# -----------------------------
set.seed(123)  # for reproducibility
sample_index <- sample(1:nrow(df), size = 0.7 * nrow(df))
trainData <- df[sample_index, ]
testData  <- df[-sample_index, ]
# Check class distribution
table(trainData$stroke)
# -----------------------------
# Apply SMOTE using smotefamily
# -----------------------------
# smotefamily requires all input features to be numeric
trainData_num <- trainData
# Identify categorical columns
categorical_cols <- c("hypertension","heart_disease","ever_married",
"work_type","smoking_status")
# Convert categorical variables to numeric
trainData_num[categorical_cols] <- lapply(trainData_num[categorical_cols], function(x) as.numeric(as.factor(x)))
# Convert target to numeric for SMOTE
trainData_num$stroke <- as.numeric(as.character(trainData_num$stroke))
# Apply SMOTE
set.seed(123)
smote_out <- SMOTE(X = trainData_num[, !(names(trainData_num) %in% "stroke")],
target = trainData_num$stroke, K = 5, dup_size = 2)
###############################################################################
#                          Step 5: Model & Prediction
###############################################################################
# Load libraries
library(rpart)        # Decision tree
library(rpart.plot)   # Plotting decision tree
library(smotefamily)  # Modern SMOTE for class imbalance
# -----------------------------
# Read cleaned dataset
# -----------------------------
df <- read.csv("cleaned_stroke_data.csv")
# Convert target variable to factor
df$stroke <- as.factor(df$stroke)
# -----------------------------
# Train/Test Split (70%/30%)
# -----------------------------
set.seed(123)  # for reproducibility
sample_index <- sample(1:nrow(df), size = 0.7 * nrow(df))
trainData <- df[sample_index, ]
testData  <- df[-sample_index, ]
# Check class distribution
table(trainData$stroke)
# -----------------------------
# Apply SMOTE using smotefamily
# -----------------------------
# smotefamily requires all input features to be numeric
trainData_num <- trainData
# Identify categorical columns
categorical_cols <- c("hypertension","heart_disease","ever_married",
"work_type","smoking_status")
# Convert categorical variables to numeric
trainData_num[categorical_cols] <- lapply(trainData_num[categorical_cols], function(x) as.numeric(as.factor(x)))
# Convert target to numeric for SMOTE
trainData_num$stroke <- as.numeric(as.character(trainData_num$stroke))
# Apply SMOTE
set.seed(123)
smote_out <- SMOTE(X = trainData_num[, !(names(trainData_num) %in% "stroke")],
target = trainData_num$stroke, K = 5, dup_size = 2)
###############################################################################
#                          Step 5: Model & Prediction (Fixed)
###############################################################################
library(rpart)
library(rpart.plot)
library(smotefamily)
# Load cleaned dataset
df <- read.csv("cleaned_stroke_data.csv")
# Convert target to factor
df$stroke <- as.factor(df$stroke)
# Train/test split
set.seed(123)
sample_index <- sample(1:nrow(df), size = 0.7 * nrow(df))
trainData <- df[sample_index, ]
testData  <- df[-sample_index, ]
# -----------------------------
# Prepare data for SMOTE
# -----------------------------
trainData_num <- trainData
# Convert all columns except numeric ones to numeric
for(col in names(trainData_num)){
if(!is.numeric(trainData_num[[col]])){
trainData_num[[col]] <- as.numeric(as.factor(trainData_num[[col]]))
}
}
# Convert target to numeric
trainData_num$stroke <- as.numeric(as.character(trainData_num$stroke))
# Check all columns are numeric
str(trainData_num)   # all columns should be numeric now
# Apply SMOTE
set.seed(123)
smote_out <- SMOTE(X = trainData_num[, !(names(trainData_num) %in% "stroke")],
target = trainData_num$stroke, K = 5, dup_size = 2)
# Prepare balanced train dataset
trainData_smote <- smote_out$data
trainData_smote$stroke <- as.factor(trainData_smote$class)
trainData_smote$class <- NULL
table(trainData_smote$stroke)
# -----------------------------
# Train Decision Tree
# -----------------------------
dt_model <- rpart(stroke ~ ., data = trainData_smote, method="class",
control=rpart.control(cp=0.01))
rpart.plot(dt_model, type=3, extra=101, fallen.leaves=TRUE,
main="Decision Tree for Stroke Prediction")
# -----------------------------
# Predictions on Test Set
# -----------------------------
pred <- predict(dt_model, newdata = testData, type="class")
###############################################################################
#                          Step 5: Model & Prediction (Fixed for Test Set)
###############################################################################
library(rpart)
library(rpart.plot)
library(smotefamily)
# Load cleaned dataset
df <- read.csv("cleaned_stroke_data.csv")
# Convert target to factor
df$stroke <- as.factor(df$stroke)
# Train/test split
set.seed(123)
sample_index <- sample(1:nrow(df), size = 0.7 * nrow(df))
trainData <- df[sample_index, ]
testData  <- df[-sample_index, ]
# -----------------------------
# Convert categorical variables to numeric
# -----------------------------
categorical_cols <- c("gender","hypertension","heart_disease",
"ever_married","work_type","Residence_type","smoking_status")
# Create a mapping of factor levels for each categorical column
level_maps <- list()
for(col in categorical_cols){
trainData[[col]] <- as.factor(trainData[[col]])
level_maps[[col]] <- levels(trainData[[col]])
trainData[[col]] <- as.numeric(trainData[[col]])
# Apply the same mapping to testData
testData[[col]] <- factor(testData[[col]], levels = level_maps[[col]])
testData[[col]] <- as.numeric(testData[[col]])
}
# Convert target to numeric for SMOTE
trainData_num <- trainData
trainData_num$stroke <- as.numeric(as.character(trainData_num$stroke))
# -----------------------------
# Apply SMOTE
# -----------------------------
set.seed(123)
smote_out <- SMOTE(X = trainData_num[, !(names(trainData_num) %in% "stroke")],
target = trainData_num$stroke, K = 5, dup_size = 2)
trainData_smote <- smote_out$data
trainData_smote$stroke <- as.factor(trainData_smote$class)
trainData_smote$class <- NULL
table(trainData_smote$stroke)
# -----------------------------
# Train Decision Tree
# -----------------------------
dt_model <- rpart(stroke ~ ., data = trainData_smote, method="class",
control=rpart.control(cp=0.01))
rpart.plot(dt_model, type=3, extra=101, fallen.leaves=TRUE,
main="Decision Tree for Stroke Prediction")
# -----------------------------
# Predictions on Test Set
# -----------------------------
pred <- predict(dt_model, newdata = testData, type="class")
# Confusion matrix and accuracy
cm <- table(Predicted = pred, Actual = testData$stroke)
print(cm)
accuracy <- sum(diag(cm))/sum(cm)
cat("Accuracy:", round(accuracy, 4), "\n")
###############################################################################
#                          Step 5: Model & Prediction (Fixed for Test Set)
###############################################################################
library(rpart)
library(rpart.plot)
library(smotefamily)
# Load cleaned dataset
df <- read.csv("cleaned_stroke_data.csv")
# Convert target to factor
df$stroke <- as.factor(df$stroke)
# Train/test split
set.seed(123)
sample_index <- sample(1:nrow(df), size = 0.7 * nrow(df))
trainData <- df[sample_index, ]
testData  <- df[-sample_index, ]
# -----------------------------
# Convert categorical variables to numeric
# -----------------------------
categorical_cols <- c("gender","hypertension","heart_disease",
"ever_married","work_type","Residence_type","smoking_status")
# Create a mapping of factor levels for each categorical column
level_maps <- list()
for(col in categorical_cols){
trainData[[col]] <- as.factor(trainData[[col]])
level_maps[[col]] <- levels(trainData[[col]])
trainData[[col]] <- as.numeric(trainData[[col]])
# Apply the same mapping to testData
testData[[col]] <- factor(testData[[col]], levels = level_maps[[col]])
testData[[col]] <- as.numeric(testData[[col]])
}
# Convert target to numeric for SMOTE
trainData_num <- trainData
trainData_num$stroke <- as.numeric(as.character(trainData_num$stroke))
# -----------------------------
# Apply SMOTE
# -----------------------------
set.seed(123)
smote_out <- SMOTE(X = trainData_num[, !(names(trainData_num) %in% "stroke")],
target = trainData_num$stroke, K = 5, dup_size = 2)
trainData_smote <- smote_out$data
trainData_smote$stroke <- as.factor(trainData_smote$class)
trainData_smote$class <- NULL
table(trainData_smote$stroke)
# -----------------------------
# Train Decision Tree
# -----------------------------
dt_model <- rpart(stroke ~ ., data = trainData_smote, method="class",
control=rpart.control(cp=0.01))
rpart.plot(dt_model, type=3, extra=101, fallen.leaves=TRUE,
main="Decision Tree for Stroke Prediction")
# -----------------------------
# Predictions on Test Set
# -----------------------------
pred <- predict(dt_model, newdata = testData, type="class")
# Confusion matrix and accuracy
cm <- table(Predicted = pred, Actual = testData$stroke)
print(cm)
accuracy <- sum(diag(cm))/sum(cm)
cat("Accuracy:", round(accuracy, 4), "\n")
###############################################################################
#                          Step 5: Model & Prediction (Improved)
###############################################################################
# Load libraries
library(rpart)        # Decision tree
library(rpart.plot)   # Plotting decision tree
library(smotefamily)  # SMOTE for class imbalance
library(caret)        # For confusion matrix and metrics
install.packages("caret", dependencies = TRUE)
###############################################################################
#                          Step 5: Model & Prediction
###############################################################################
xcode-select --install
###############################################################################
#                          Step 5: Model & Prediction
###############################################################################
install.packages("caret", type = "source", dependencies = TRUE)
###############################################################################
#                          Step 5: Model & Prediction
###############################################################################
# Load libraries
library(rpart)        # Decision tree
library(rpart.plot)   # Plotting decision tree
library(smotefamily)  # SMOTE for class imbalance
library(caret)        # For confusion matrix and metrics
###############################################################################
#                          Step 5: Model & Prediction
###############################################################################
# Load libraries
library(rpart)        # Decision tree
library(rpart.plot)   # Plotting decision tree
library(smotefamily)  # SMOTE for class imbalance
library(caret)        # For confusion matrix and metrics
